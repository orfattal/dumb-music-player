{% extends "base.html" %}

{% block title %}תוצאות חיפוש{% endblock %}

{% block content %}
<div class="nav">
    <a href="{{ url_for('public_search') }}">&lt; חזרה לחיפוש</a> |
    <a href="{{ url_for('index') }}">דף הבית</a>
</div>

<h1>תוצאות חיפוש: {{ song_name }} - {{ artist_name }}</h1>

<p>תוצאות מיוטיוב:</p>

{% for video in results %}
<div class="search-result" id="result_{{ loop.index0 }}">
    <table width="100%" cellpadding="5" cellspacing="0" border="0">
        <tr>
            <td width="130" valign="top">
                <img src="{{ video.thumbnail }}" alt="{{ video.title }}" width="120" height="90" style="border-radius: 5px; cursor: pointer;" onclick="togglePlayer({{ loop.index0 }})">
            </td>
            <td valign="top">
                <strong>{{ video.title }}</strong>
                <br>
                <small>ערוץ: {{ video.channel }}</small>
                <br>
                {% if video.duration %}
                <small>משך: {{ (video.duration // 60) }}:{{ '%02d' % (video.duration % 60) }}</small>
                {% endif %}
                <br><br>
                <a href="#" class="button" onclick="togglePlayer({{ loop.index0 }}); return false;">▶ נגן</a>
            </td>
        </tr>
    </table>
    <div id="player_{{ loop.index0 }}" style="display: none; margin-top: 10px;">
        <iframe width="100%" height="200"
                src="https://www.youtube.com/embed/{{ video.id }}"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen
                style="max-width: 100%; border-radius: 5px;">
        </iframe>
    </div>
</div>
{% endfor %}

<script>
function togglePlayer(index) {
    var player = document.getElementById('player_' + index);
    if (player) {
        if (player.style.display === 'none') {
            player.style.display = 'block';
        } else {
            player.style.display = 'none';
        }
    }
}
</script>

<style>
.search-result {
    border: 2px solid #ddd;
    margin: 15px 0;
    padding: 10px;
    border-radius: 5px;
    background: #fff;
}

small {
    color: #666;
}
</style>
{% endblock %}
